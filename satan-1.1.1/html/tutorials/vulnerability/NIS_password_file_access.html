<HTML>
<HEAD>
<TITLE>Tutorial - NIS password file access</TITLE>
<LINK REV="made" HREF="mailto:satan@fish.com">
</HEAD>
<BODY>

<H1><IMG SRC="../../images/satan.gif">NIS password file access</H1>

<HR>

<H3>Summary</H3>

NIS password file access by arbitrary hosts.

<H3>Impact</H3>

Allows automated password guessing attacks.

<H3>Background</H3>

The NIS (Network Information Service) implements network-wide access to
administrative information. Examples of databases (also called NIS maps)
that are shared via NIS:

<ul>

<li>the password file that describes what users have access to the system,

<li>the table with names and addresses of hosts on the network, 

<li>electronic mail aliases.

</ul>

NIS databases are organized in domains.  One NIS server can serve
multiple NIS domains. In order to perform a query, a client sends a
request to a NIS server and specifies 

<ul>

<li>a NIS domain name, 

<li>the name of the database (NIS map) to be searched, 

<li>a search key.

</ul>

<H3>The problem</H3>

Many NIS implementations provide no access control. Every host that
asks for information will receive a reply. In order to perform a query,
one needs to know the server's NIS domain name. Often, this name is
easy to guess, or it can be obtained via the <em>bootparam</em>
network service.

<p>

When the local network is accessible from other networks, a remote
intruder can collect password file information and run a password
guessing program.  Many people (including
<a href="ftp://coast.cs.purdue.edu/pub/doc/passwords/Dan_Klein_password.ps.Z">
Dan Klein</a>) have demonstrated that people tend to choose passwords that
are easy to guess.

<H3>Fix</H3>

<ul>

<li>Several vendors have added access control to their <em> ypserv</em>
implementation. Check your system documentation or vendor patch
list. The control file is sometimes called <em>securenets</em>.

</ul>

<H3>Workarounds</H3>

<ul>

<li>Run a <a href="ftp://ftp.win.tue.nl/pub/security/index.html">portmapper
</a>with access control.

</ul>

<H3>Other tips</H3>

<ul>

<li>Consider blocking ports 111 (portmap) on your network gateway.
This makes attacks on NIS and NFS mount daemons much harder.

<li>Enforce a policy for choosing passwords by installing an
alternative <em>passwd</em> command, for example
<a href="ftp://coast.cs.purdue.edu/pub/tools/unix/anlpasswd">anlpasswd</a>.

<li>See the
<a href="../../docs/admin_guide_to_cracking.html#nis-passwords">Admin
Guide to Cracking</a> for an example of why this is a problem.

</ul>
</BODY>
</HTML>
