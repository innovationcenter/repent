<HTML>
<HEAD>
<TITLE>Tutorial - Unrestricted NFS export</TITLE>
<LINK REV="made" HREF="mailto:satan@fish.com">
</HEAD>
<BODY>

<H1><IMG SRC="../../images/satan.gif">Unrestricted NFS export</H1>

<HR>

<H3>Summary</H3>

File systems exported via NFS to arbitrary hosts.

<H3>Impact</H3>

Unauthorized remote access to system and/or user files.

<H3>The problem</H3>

When a file system is exported without restriction, an intruder can
remotely compromise user or system files, and then take over the
machine.  Examples:

<ul>

<li>An intruder can remotely replace a system program or configuration
file.

</ul>

UNIX-specific examples:

<ul>

<li>An intruder can remotely install a <em> .rhosts</em> file to
obtain interactive access.

<li>An intruder can remotely install a <em> .forward</em> file to
obtain non-interactive access.

</ul>

<H3>Fix</H3>

<ul>

<li>Make sure all file exports specify an explicit list of clients or
netgroups.

<li>Export file systems read-only where possible.

</ul>

<H3>Other tips</H3>

<ul>

<li>Some versions of the NFS mount daemon cannot expand large
netgroups and will export to the world anyway; see also <a
href="ftp://ftp.cert.org:/pub/cert_advisories/CA-94:02.REVISED.SunOS.rpc.mountd.vulnerability">
Cert advisory CA-94:02</a>.  Check your vendor patch list.

<li>In NIS netgroup members, empty host fields are treated as
wildcards and cause the mount daemon to grant access to any host.

<li>Consider blocking ports 2049 (nfs) and 111 (portmap) on your
routers.

<li>See the
<a href="../../docs/admin_guide_to_cracking.html#unrestricted-NFS-export">Admin
Guide to Cracking</a> for an example of why this is a problem.

</ul>
</BODY>
</HTML>
